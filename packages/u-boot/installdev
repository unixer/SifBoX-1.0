#!/bin/sh

. config/options

. $CONFIG_MACHINE/meta

mkdir -p $INSTALL/share/u-boot

if [ -n "$MACHINE_UBOOT_BINARY" ]; then
  cp $BUILD/$1*/$MACHINE_UBOOT_BINARY $INSTALL/share/u-boot
else
  cp $BUILD/$1*/u-boot.bin $INSTALL/share/u-boot
fi

if [ -n "$MACHINE_UBOOT_CONFIG_EXTRA" ]; then
  mkdir -p $INSTALL/share/u-boot/extra-uboot
  cp $BUILD/$1*/extra-uboot/* $INSTALL/share/u-boot/extra-uboot
fi

if [ -n "$MACHINE_UBOOT_LOADER" ]; then
  cp $BUILD/$1*/$MACHINE_UBOOT_LOADER $INSTALL/share/u-boot
fi

[ -r $BUILD/$1*/MLO ] && \
  cp $BUILD/$1*/MLO $INSTALL/share/u-boot

[ -r $BUILD/$1*/boot.cfg ] && \
  cp $BUILD/$1*/boot.cfg $INSTALL/share/u-boot

if [ -r $BUILD/$1*/boot.ini ]; then
  if [ -n "$MACHINE_UBOOT_SCRIPT" ]; then
    cp $BUILD/$1*/boot.ini $INSTALL/share/u-boot/$MACHINE_UBOOT_SCRIPT
  else
    cp $BUILD/$1*/boot.ini $INSTALL/share/u-boot
    # some boards read boot.scr by default
    cp $INSTALL/share/u-boot/boot.ini $INSTALL/share/u-boot/boot.scr
  fi  
fi

exit 0
