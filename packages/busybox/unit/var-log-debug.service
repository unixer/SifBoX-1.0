[Unit]
Description=Debug /var/log relink
DefaultDependencies=false
After=systemd-tmpfiles-setup.service var.mount
Before=systemd-journal-flush.service

ConditionKernelCommandLine=!installer
ConditionKernelCommandLine=|debugging
ConditionPathExists=|/var/log

[Service]
Type=oneshot
ExecStartPre=/bin/sh -c 'if [ ! -d /var/log ]; then rm -rf /var/log &>/dev/null; fi'
ExecStart=/bin/sh -c 'rm -rf /var/log && mkdir -p /var/log/journal'
RemainAfterExit=yes

[Install]
WantedBy=sysinit.target
