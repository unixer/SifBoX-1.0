#!/bin/sh

PACKAGE="$1"

if [ -z "$PACKAGE" ]; then
  echo "Usage: newpackage <packagename>"
  exit 1
fi

mkdir -p packages/$PACKAGE

cat > packages/$PACKAGE/meta <<EOF
PKG_NAME=$PACKAGE
PKG_VERSION=0.0invalid
PKG_URL="http://fill-in-$PACKAGE-$PKG_VERSION-download-url.invalid"
PKG_REV=1
PKG_DEPENDS="\$TARGET_LIBC"
PKG_BUILD_DEPENDS="toolchain"
PKG_PRIORITY=optional
PKG_SECTION=misc
PKG_SHORTDESC="$PACKAGE (autogenerated)"
PKG_LONGDESC=""
EOF

cat > packages/$PACKAGE/build <<EOF
#!/bin/sh

. config/options

get_meta $1
cd \$PKG_BUILD_DIR
do_configure
make
do_strip bin lib$1.so.*
make_install
EOF
chmod +x packages/$PACKAGE/build

cat > packages/$PACKAGE/install <<EOF
#!/bin/sh

. config/options

get_meta $1
cd \$PKG_BUILD_DIR

do_install usr/bin
EOF
chmod +x packages/$PACKAGE/install

cat > packages/$PACKAGE/installdev <<EOF
#!/bin/sh

. config/options

get_meta $1
cd \$PKG_BUILD_DIR

do_installdev usr/include
do_installdev usr/lib
EOF
chmod +x packages/$PACKAGE/installdev
